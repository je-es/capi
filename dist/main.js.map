{"version":3,"sources":["../src/main.ts"],"names":["apiConfig","configureApi","config","getApiConfig","resetApiConfig","api","options","error","createApiError","url","queryString","acc","key","value","fetchOptions","createAbortSignal","contentType","response","data","text","apiResponse","apiError","http","timeout","controller","message","status"],"mappings":"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","file":"main.js","sourcesContent":["// src/main.ts\r\n//\r\n// Made with ❤️ by Maysara.\r\n\r\n\r\n\r\n// ╔════════════════════════════════════════ PACK ════════════════════════════════════════╗\r\n\r\n    import type { ApiOptions, ApiResponse, ApiError, ApiConfig } from './types.d';\r\n    export * from './types.d';\r\n\r\n// ╚══════════════════════════════════════════════════════════════════════════════════════╝\r\n\r\n\r\n\r\n// ╔════════════════════════════════════════ INIT ════════════════════════════════════════╗\r\n\r\n    let apiConfig: ApiConfig = {\r\n        baseURL         : '',\r\n        timeout         : 30000,\r\n        headers         : {},\r\n        interceptors    : {\r\n            request     : null,\r\n            response    : null,\r\n            error       : null,\r\n        },\r\n    };\r\n\r\n// ╚══════════════════════════════════════════════════════════════════════════════════════╝\r\n\r\n\r\n\r\n// ╔════════════════════════════════════════ CORE ════════════════════════════════════════╗\r\n\r\n    /**\r\n     * Configure API client\r\n     */\r\n    export function configureApi(config: Partial<ApiConfig>): void {\r\n        apiConfig = {\r\n            ...apiConfig,\r\n            ...config,\r\n            headers: { ...apiConfig.headers, ...config.headers },\r\n            interceptors: { ...apiConfig.interceptors, ...config.interceptors },\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Get current API configuration\r\n     */\r\n    export function getApiConfig(): Readonly<ApiConfig> {\r\n        return { ...apiConfig };\r\n    }\r\n\r\n    /**\r\n     * Reset API configuration to defaults\r\n     */\r\n    export function resetApiConfig(): void {\r\n        apiConfig = {\r\n            baseURL: '',\r\n            timeout: 30000,\r\n            headers: {},\r\n            interceptors: {\r\n                request: null,\r\n                response: null,\r\n                error: null,\r\n            },\r\n        };\r\n    }\r\n\r\n    /**\r\n     * API client with improved error handling and type safety\r\n     */\r\n    export async function api<T = any>(options: ApiOptions): Promise<ApiResponse<T>> {\r\n        // Merge with default config\r\n        let config: ApiOptions = {\r\n            method: options.method || 'GET',\r\n            url: options.url,\r\n            data: options.data,\r\n            headers: { ...apiConfig.headers, ...options.headers },\r\n            params: options.params,\r\n            timeout: options.timeout ?? apiConfig.timeout,\r\n        };\r\n\r\n        // Apply request interceptor\r\n        if (apiConfig.interceptors.request) {\r\n            try {\r\n                config = await Promise.resolve(apiConfig.interceptors.request(config));\r\n            } catch (error) {\r\n                throw createApiError('Request interceptor failed', 0, error);\r\n            }\r\n        }\r\n\r\n        // Build URL\r\n        let url = config.url.startsWith('http')\r\n            ? config.url\r\n            : `${apiConfig.baseURL}${config.url}`;\r\n\r\n        // Add query params\r\n        if (config.params && Object.keys(config.params).length > 0) {\r\n            const queryString = new URLSearchParams(\r\n                Object.entries(config.params).reduce((acc, [key, value]) => {\r\n                    if (value != null) {\r\n                        acc[key] = String(value);\r\n                    }\r\n                    return acc;\r\n                }, {} as Record<string, string>)\r\n            ).toString();\r\n\r\n            if (queryString) {\r\n                url += (url.includes('?') ? '&' : '?') + queryString;\r\n            }\r\n        }\r\n\r\n        // Prepare fetch options\r\n        const fetchOptions: RequestInit = {\r\n            method: config.method,\r\n            headers: config.headers,\r\n            signal: createAbortSignal(config.timeout || 30000),\r\n        };\r\n\r\n        // Add body for non-GET requests\r\n        if (config.data && config.method !== 'GET' && config.method !== 'HEAD') {\r\n            const contentType = config.headers?.['Content-Type'] || config.headers?.['content-type'];\r\n\r\n            if (contentType?.includes('application/json')) {\r\n                fetchOptions.body = JSON.stringify(config.data);\r\n            } else if (config.data instanceof FormData) {\r\n                fetchOptions.body = config.data;\r\n                // Let browser set Content-Type with boundary for FormData\r\n                delete fetchOptions.headers;\r\n                fetchOptions.headers = { ...config.headers };\r\n                delete (fetchOptions.headers as any)['Content-Type'];\r\n            } else if (config.data instanceof Blob) {\r\n                fetchOptions.body = config.data;\r\n            } else if (typeof config.data === 'string') {\r\n                fetchOptions.body = config.data;\r\n            } else {\r\n                // Default to JSON\r\n                fetchOptions.body = JSON.stringify(config.data);\r\n                if (!contentType) {\r\n                    (fetchOptions.headers as Record<string, string>)['Content-Type'] = 'application/json';\r\n                }\r\n            }\r\n        }\r\n\r\n        try {\r\n            // Make request\r\n            const response = await fetch(url, fetchOptions);\r\n\r\n            // Parse response\r\n            let data: T;\r\n            const contentType = response.headers.get('Content-Type') || '';\r\n\r\n            if (contentType.includes('application/json')) {\r\n                const text = await response.text();\r\n                data = text ? JSON.parse(text) : null;\r\n            } else if (contentType.includes('text/')) {\r\n                data = await response.text() as any;\r\n            } else if (contentType.includes('application/octet-stream') || contentType.includes('application/pdf')) {\r\n                data = await response.blob() as any;\r\n            } else {\r\n                // Try to parse as JSON first, fall back to text\r\n                const text = await response.text();\r\n                try {\r\n                    data = text ? JSON.parse(text) : text as any;\r\n                } catch {\r\n                    data = text as any;\r\n                }\r\n            }\r\n\r\n            // Check for HTTP errors\r\n            if (!response.ok) {\r\n                const error = createApiError(\r\n                    response.statusText || 'Request failed',\r\n                    response.status,\r\n                    data\r\n                );\r\n\r\n                // Apply error interceptor\r\n                if (apiConfig.interceptors.error) {\r\n                    return apiConfig.interceptors.error(error);\r\n                }\r\n\r\n                throw error;\r\n            }\r\n\r\n            // Create response object\r\n            const apiResponse: ApiResponse<T> = {\r\n                data,\r\n                status: response.status,\r\n                statusText: response.statusText,\r\n                headers: {},\r\n            };\r\n\r\n            // Convert headers to object\r\n            response.headers.forEach((value, key) => {\r\n                apiResponse.headers[key] = value;\r\n            });\r\n\r\n            // Apply response interceptor\r\n            if (apiConfig.interceptors.response) {\r\n                return await Promise.resolve(apiConfig.interceptors.response(apiResponse));\r\n            }\r\n\r\n            return apiResponse;\r\n\r\n        } catch (error: any) {\r\n            // Handle different error types\r\n            let apiError: ApiError;\r\n\r\n            if (error.name === 'AbortError') {\r\n                apiError = createApiError('Request timeout', 0, null);\r\n            } else if (error instanceof TypeError && error.message.includes('fetch')) {\r\n                apiError = createApiError('Network error', 0, null);\r\n            } else if (error.message && error.status !== undefined) {\r\n                // Already an ApiError\r\n                apiError = error;\r\n            } else {\r\n                apiError = createApiError(\r\n                    error.message || 'Unknown error',\r\n                    error.status || 0,\r\n                    error.data || null\r\n                );\r\n            }\r\n\r\n            // Apply error interceptor\r\n            if (apiConfig.interceptors.error) {\r\n                return apiConfig.interceptors.error(apiError);\r\n            }\r\n\r\n            throw apiError;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Convenience methods with improved typing\r\n     */\r\n    export const http = {\r\n        get: <T = any>(url: string, options?: Partial<ApiOptions>): Promise<ApiResponse<T>> =>\r\n            api<T>({ ...options, method: 'GET', url }),\r\n\r\n        post: <T = any>(url: string, data?: any, options?: Partial<ApiOptions>): Promise<ApiResponse<T>> =>\r\n            api<T>({ ...options, method: 'POST', url, data }),\r\n\r\n        put: <T = any>(url: string, data?: any, options?: Partial<ApiOptions>): Promise<ApiResponse<T>> =>\r\n            api<T>({ ...options, method: 'PUT', url, data }),\r\n\r\n        patch: <T = any>(url: string, data?: any, options?: Partial<ApiOptions>): Promise<ApiResponse<T>> =>\r\n            api<T>({ ...options, method: 'PATCH', url, data }),\r\n\r\n        delete: <T = any>(url: string, options?: Partial<ApiOptions>): Promise<ApiResponse<T>> =>\r\n            api<T>({ ...options, method: 'DELETE', url }),\r\n\r\n        head: <T = any>(url: string, options?: Partial<ApiOptions>): Promise<ApiResponse<T>> =>\r\n            api<T>({ ...options, method: 'HEAD', url }),\r\n\r\n        options: <T = any>(url: string, options?: Partial<ApiOptions>): Promise<ApiResponse<T>> =>\r\n            api<T>({ ...options, method: 'OPTIONS', url }),\r\n    };\r\n\r\n// ╚══════════════════════════════════════════════════════════════════════════════════════╝\r\n\r\n\r\n\r\n// ╔════════════════════════════════════════ HELP ════════════════════════════════════════╗\r\n\r\n    /**\r\n     * Create AbortSignal with timeout\r\n     */\r\n    function createAbortSignal(timeout: number): AbortSignal {\r\n        const controller = new AbortController();\r\n        setTimeout(() => controller.abort(), timeout);\r\n        return controller.signal;\r\n    }\r\n\r\n    /**\r\n     * Create standardized API error\r\n     */\r\n    function createApiError(message: string, status: number, data: any): ApiError {\r\n        return {\r\n            message,\r\n            status,\r\n            data,\r\n        };\r\n    }\r\n\r\n// ╚══════════════════════════════════════════════════════════════════════════════════════╝"]}