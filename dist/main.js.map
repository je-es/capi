{"version":3,"sources":["../src/main.ts"],"names":["apiConfig","configureApi","config","getApiConfig","resetApiConfig","api","options","error","createApiError","url","queryString","acc","key","value","fetchOptions","createAbortSignal","contentType","response","data","text","apiResponse","apiError","isApiError","http","timeout","controller","message","status"],"mappings":"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","file":"main.js","sourcesContent":["// src/main.ts\r\n//\r\n// Made with ❤️ by Maysara.\r\n\r\n\r\n\r\n// ╔════════════════════════════════════════ PACK ════════════════════════════════════════╗\r\n\r\n    import type { ApiOptions, ApiResponse, ApiError, ApiConfig, RequestData } from './types.d';\r\n    export * from './types.d';\r\n\r\n// ╚══════════════════════════════════════════════════════════════════════════════════════╝\r\n\r\n\r\n\r\n// ╔════════════════════════════════════════ INIT ════════════════════════════════════════╗\r\n\r\n    let apiConfig: ApiConfig = {\r\n        baseURL         : '',\r\n        timeout         : 30000,\r\n        headers         : {},\r\n        interceptors    : {\r\n            request     : null,\r\n            response    : null,\r\n            error       : null,\r\n        },\r\n    };\r\n\r\n// ╚══════════════════════════════════════════════════════════════════════════════════════╝\r\n\r\n\r\n\r\n// ╔════════════════════════════════════════ CORE ════════════════════════════════════════╗\r\n\r\n    /**\r\n     * Configure API client\r\n     */\r\n    export function configureApi(config: Partial<ApiConfig>): void {\r\n        apiConfig = {\r\n            ...apiConfig,\r\n            ...config,\r\n            headers: { ...apiConfig.headers, ...config.headers },\r\n            interceptors: { ...apiConfig.interceptors, ...config.interceptors },\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Get current API configuration\r\n     */\r\n    export function getApiConfig(): Readonly<ApiConfig> {\r\n        return { ...apiConfig };\r\n    }\r\n\r\n    /**\r\n     * Reset API configuration to defaults\r\n     */\r\n    export function resetApiConfig(): void {\r\n        apiConfig = {\r\n            baseURL: '',\r\n            timeout: 30000,\r\n            headers: {},\r\n            interceptors: {\r\n                request: null,\r\n                response: null,\r\n                error: null,\r\n            },\r\n        };\r\n    }\r\n\r\n    /**\r\n     * API client with improved error handling and type safety\r\n     */\r\n    export async function api<T = unknown>(options: ApiOptions): Promise<ApiResponse<T>> {\r\n        // Merge with default config\r\n        let config: ApiOptions = {\r\n            method: options.method || 'GET',\r\n            url: options.url,\r\n            data: options.data,\r\n            headers: { ...apiConfig.headers, ...options.headers },\r\n            params: options.params,\r\n            timeout: options.timeout ?? apiConfig.timeout,\r\n        };\r\n\r\n        // Apply request interceptor\r\n        if (apiConfig.interceptors.request) {\r\n            try {\r\n                config = await Promise.resolve(apiConfig.interceptors.request(config));\r\n            } catch (error) {\r\n                throw createApiError('Request interceptor failed', 0, error);\r\n            }\r\n        }\r\n\r\n        // Build URL\r\n        let url = config.url.startsWith('http')\r\n            ? config.url\r\n            : `${apiConfig.baseURL}${config.url}`;\r\n\r\n        // Add query params\r\n        if (config.params && Object.keys(config.params).length > 0) {\r\n            const queryString = new URLSearchParams(\r\n                Object.entries(config.params).reduce((acc, [key, value]) => {\r\n                    if (value != null) {\r\n                        acc[key] = String(value);\r\n                    }\r\n                    return acc;\r\n                }, {} as Record<string, string>)\r\n            ).toString();\r\n\r\n            if (queryString) {\r\n                url += (url.includes('?') ? '&' : '?') + queryString;\r\n            }\r\n        }\r\n\r\n        // Prepare fetch options\r\n        const fetchOptions: RequestInit = {\r\n            method: config.method,\r\n            headers: config.headers,\r\n            signal: createAbortSignal(config.timeout || 30000),\r\n        };\r\n\r\n        // Add body for non-GET requests\r\n        if (config.data && config.method !== 'GET' && config.method !== 'HEAD') {\r\n            const contentType = config.headers?.['Content-Type'] || config.headers?.['content-type'];\r\n\r\n            if (contentType?.includes('application/json')) {\r\n                fetchOptions.body = JSON.stringify(config.data);\r\n            } else if (config.data instanceof FormData) {\r\n                fetchOptions.body = config.data;\r\n                // Let browser set Content-Type with boundary for FormData\r\n                delete fetchOptions.headers;\r\n                fetchOptions.headers = { ...config.headers };\r\n                delete (fetchOptions.headers as Record<string, string>)['Content-Type'];\r\n            } else if (config.data instanceof Blob) {\r\n                fetchOptions.body = config.data;\r\n            } else if (typeof config.data === 'string') {\r\n                fetchOptions.body = config.data;\r\n            } else {\r\n                // Default to JSON\r\n                fetchOptions.body = JSON.stringify(config.data);\r\n                if (!contentType) {\r\n                    (fetchOptions.headers as Record<string, string>)['Content-Type'] = 'application/json';\r\n                }\r\n            }\r\n        }\r\n\r\n        try {\r\n            // Make request\r\n            const response = await fetch(url, fetchOptions);\r\n\r\n            // Parse response\r\n            let data: T;\r\n            const contentType = response.headers.get('Content-Type') || '';\r\n\r\n            if (contentType.includes('application/json')) {\r\n                const text = await response.text();\r\n                data = text ? JSON.parse(text) : null;\r\n            } else if (contentType.includes('text/')) {\r\n                data = await response.text() as T;\r\n            } else if (contentType.includes('application/octet-stream') || contentType.includes('application/pdf')) {\r\n                data = await response.blob() as T;\r\n            } else {\r\n                // Try to parse as JSON first, fall back to text\r\n                const text = await response.text();\r\n                try {\r\n                    data = text ? JSON.parse(text) : text as T;\r\n                } catch {\r\n                    data = text as T;\r\n                }\r\n            }\r\n\r\n            // Check for HTTP errors\r\n            if (!response.ok) {\r\n                const error = createApiError(\r\n                    response.statusText || 'Request failed',\r\n                    response.status,\r\n                    data\r\n                );\r\n\r\n                // Apply error interceptor\r\n                if (apiConfig.interceptors.error) {\r\n                    return apiConfig.interceptors.error(error) as Promise<ApiResponse<T>>;\r\n                }\r\n\r\n                throw error;\r\n            }\r\n\r\n            // Create response object\r\n            const apiResponse: ApiResponse<T> = {\r\n                data,\r\n                status: response.status,\r\n                statusText: response.statusText,\r\n                headers: {},\r\n            };\r\n\r\n            // Convert headers to object\r\n            response.headers.forEach((value, key) => {\r\n                apiResponse.headers[key] = value;\r\n            });\r\n\r\n            // Apply response interceptor\r\n            if (apiConfig.interceptors.response) {\r\n                return await Promise.resolve(apiConfig.interceptors.response(apiResponse));\r\n            }\r\n\r\n            return apiResponse;\r\n\r\n        } catch (error: unknown) {\r\n            // Handle different error types\r\n            let apiError: ApiError;\r\n\r\n            if (error instanceof Error) {\r\n                if (error.name === 'AbortError') {\r\n                    apiError = createApiError('Request timeout', 0, null);\r\n                } else if (error instanceof TypeError && error.message.includes('fetch')) {\r\n                    apiError = createApiError('Network error', 0, null);\r\n                } else {\r\n                    apiError = createApiError(\r\n                        error.message || 'Unknown error',\r\n                        0,\r\n                        null\r\n                    );\r\n                }\r\n            } else if (isApiError(error)) {\r\n                // Already an ApiError\r\n                apiError = error;\r\n            } else {\r\n                apiError = createApiError('Unknown error', 0, null);\r\n            }\r\n\r\n            // Apply error interceptor\r\n            if (apiConfig.interceptors.error) {\r\n                return apiConfig.interceptors.error(apiError) as Promise<ApiResponse<T>>;\r\n            }\r\n\r\n            throw apiError;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Convenience methods with improved typing\r\n     */\r\n    export const http = {\r\n        get: <T = unknown>(url: string, options?: Partial<ApiOptions>): Promise<ApiResponse<T>> =>\r\n            api<T>({ ...options, method: 'GET', url }),\r\n\r\n        post: <T = unknown>(url: string, data?: RequestData, options?: Partial<ApiOptions>): Promise<ApiResponse<T>> =>\r\n            api<T>({ ...options, method: 'POST', url, data }),\r\n\r\n        put: <T = unknown>(url: string, data?: RequestData, options?: Partial<ApiOptions>): Promise<ApiResponse<T>> =>\r\n            api<T>({ ...options, method: 'PUT', url, data }),\r\n\r\n        patch: <T = unknown>(url: string, data?: RequestData, options?: Partial<ApiOptions>): Promise<ApiResponse<T>> =>\r\n            api<T>({ ...options, method: 'PATCH', url, data }),\r\n\r\n        delete: <T = unknown>(url: string, options?: Partial<ApiOptions>): Promise<ApiResponse<T>> =>\r\n            api<T>({ ...options, method: 'DELETE', url }),\r\n\r\n        head: <T = unknown>(url: string, options?: Partial<ApiOptions>): Promise<ApiResponse<T>> =>\r\n            api<T>({ ...options, method: 'HEAD', url }),\r\n\r\n        options: <T = unknown>(url: string, options?: Partial<ApiOptions>): Promise<ApiResponse<T>> =>\r\n            api<T>({ ...options, method: 'OPTIONS', url }),\r\n    };\r\n\r\n// ╚══════════════════════════════════════════════════════════════════════════════════════╝\r\n\r\n\r\n\r\n// ╔════════════════════════════════════════ HELP ════════════════════════════════════════╗\r\n\r\n    /**\r\n     * Create AbortSignal with timeout\r\n     */\r\n    function createAbortSignal(timeout: number): AbortSignal {\r\n        const controller = new AbortController();\r\n        setTimeout(() => controller.abort(), timeout);\r\n        return controller.signal;\r\n    }\r\n\r\n    /**\r\n     * Create standardized API error\r\n     */\r\n    function createApiError<T = unknown>(message: string, status: number, data: T | null): ApiError<T> {\r\n        return {\r\n            message,\r\n            status,\r\n            data,\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Type guard to check if error is ApiError\r\n     */\r\n    function isApiError(error: unknown): error is ApiError {\r\n        return (\r\n            typeof error === 'object' &&\r\n            error !== null &&\r\n            'message' in error &&\r\n            'status' in error\r\n        );\r\n    }\r\n\r\n// ╚══════════════════════════════════════════════════════════════════════════════════════╝"]}